{% extends "base.html" %}

{% block title %}Crypto Master - SecureCTF{% endblock %}

{% block content %}
<div class="mb-8">
    <h1>Level 2: Crypto Master</h1>
    <p class="text-secondary">Can you decode the encrypted message?</p>
</div>

<div class="grid">
    <div class="card">
        <h2>Challenge Description</h2>
        <p class="text-secondary mb-4">
            Welcome to the Cryptography challenge! You'll need to use your knowledge of:
        </p>
        <ul style="color: var(--text-secondary); margin-bottom: 1.5rem; padding-left: 1.5rem;">
            <li>Base64 encoding</li>
            <li>ROT13 cipher</li>
            <li>Basic cryptography concepts</li>
        </ul>
        <div style="background: var(--hover-bg); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
            <p style="font-family: monospace; margin: 0; word-break: break-all;">
                Encrypted message: {{ encrypted_message }}
            </p>
        </div>
        <p class="text-secondary mb-4">
            Hint: The message has been encoded twice. First with ROT13, then with Base64.
        </p>
    </div>

    <div class="card">
        <h2>Submit Flag</h2>
        {% if error %}
        <div class="alert alert-error mb-4">
            {{ error }}
        </div>
        {% endif %}
        {% if success %}
        <div class="alert alert-success mb-4">
            <strong>Congratulations!</strong> You've completed Level 2!
        </div>
        {% endif %}
        <form method="POST" action="{{ url_for('level2') }}">
            <div class="mb-4">
                <input type="text" name="flag" class="input-field" placeholder="Enter the flag" required>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Submit Flag</button>
        </form>
    </div>
</div>

{% if not success %}
<div class="card" style="margin-top: 2rem;">
    <h2>Need Help?</h2>
    <p class="text-secondary mb-4">
        Here are some tips to get you started:
    </p>
    <ul style="color: var(--text-secondary); margin-bottom: 1.5rem; padding-left: 1.5rem;">
        <li>Try decoding the Base64 first, then apply ROT13</li>
        <li>There are many online tools that can help with both Base64 and ROT13</li>
        <li>Remember that the flag format is CTF{...}</li>
    </ul>
</div>
{% endif %}
{% endblock %} 